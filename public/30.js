(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{123:function(e,t,a){"use strict";a.r(t);var i={layout:"admin",middleware:["auth","admin"],metaInfo:{title:"Products",titleTemplate:"%s | Khodgi"},components:{},data:function(){return{date:null,menu_special_price_start:null,menu_special_price_end:null,menu_new_from:null,menu_new_to:null,trip:{name:"",location:null,start:null,end:null},locations:["Australia","Barbados","Chile","Denmark","Equador","France"],attrib:"",attribs:[],subattrib:"",subattribs:[],valid:!0,dialog:!1,loading:!1,snackbar:!1,text:"",roles:[],success:"",error:"",categories:[],options:{sortBy:["name"],sortDesc:[!0]},rules:{required:function(e){return!!e||"This Field is Required"},min:function(e){return e.length>=5||"Minimum 5 Chracters Required"},validEmail:function(e){return/.+@.+\..+/.test(e)||"Email must be valid"}},headers:[{text:"#",value:"id"},{text:"Thumbnail",value:"image1"},{text:"Name",value:"name"},{text:"Price",value:"price"},{text:"Status",value:"is_active"},{text:"Created",value:"created_at"},{text:"Actions",value:"action",sortable:!1}],products:[],editedIndex:-1,editedItem:{id:"",name:"",category_id:"",description:"",isActive:"",price_pkr:"",price_usd:"",price_aud:"",price_eur:"",price_gbp:"",special_price_percentage:"",special_price_start:"",special_price_end:"",manage_inventory:"",quantity:"",image1:null,image2:null,image3:null,image4:null,new_from:"",new_to:"",created_at:"",size_attribs:[{attribute_set:"",attribute:"",xs:"",s:"",m:"",l:"",xl:""}]},defaultItem:{id:"",name:"",category_id:"",description:"",isActive:"",price_pkr:"",price_usd:"",price_aud:"",price_eur:"",price_gbp:"",special_price_percentage:"",special_price_start:"",special_price_end:"",manage_inventory:"",quantity:"",image1:"",image2:"",image3:"",image4:"",new_from:"",new_to:"",created_at:""}}},computed:{formTitle:function(){return-1===this.editedIndex?"New Product":"Edit Product"},passwordMatch:function(){return this.editedItem.password==this.editedItem.rpassword||"Password does Not Match"}},watch:{dialog:function(e){e||this.close()}},created:function(){var e=this;this.initialize(),axios.get("/api/admin/attributes").then((function(t){e.subattribs=t.data.attributes})),axios.get("/api/admin/categories").then((function(t){e.categories=t.data.data}))},methods:{uploadImage1:function(e){var t=this,a=e.target.files[0],i=new FileReader;a.size<1e6?(i.onloadend=function(e){t.editedItem.image1=i.result},i.readAsDataURL(a)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage2:function(e){var t=this,a=e.target.files[0],i=new FileReader;a.size<1e6?(i.onloadend=function(e){t.editedItem.image2=i.result},i.readAsDataURL(a)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage3:function(e){var t=this,a=e.target.files[0],i=new FileReader;a.size<1e6?(i.onloadend=function(e){t.editedItem.image3=i.result},i.readAsDataURL(a)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage4:function(e){var t=this,a=e.target.files[0],i=new FileReader;a.size<1e6?(i.onloadend=function(e){t.editedItem.image4=i.result},i.readAsDataURL(a)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadPhoto:function(e){var t=this;if(null!=this.editedItem.photo){var a=this.products.data.indexOf(e);console.log(this.editedItem);var i=new FormData;i.append("photo",this.editedItem.photo,this.editedItem.photo.name),i.append("user",e.id),axios.post("/api/admin/change-photo",i).then((function(e){t.products.data[a].photo=e.data.data.user.photo,t.editedItem.photo=null})).catch((function(e){return console.log(e.response)}))}},updateRole:function(e){var t=this,a=this.products.data.indexOf(e);axios.post("/api/admin/change-role",{role:e.role,user:e.id}).then((function(e){t.text=e.data.data.user.name+"'s Role Updated to "+e.data.data.user.role,t.snackbar=!0})).catch((function(e){t.text=e.response.data.user.name+"'s Role Cannot be Updated"+e.response.data.user.role,t.products.data[a].role=e.response.data.user.role,t.snackbar=!0,console.dir(e.response)}))},checkEmail:function(){var e=this;/.+@.+\..+/.test(this.editedItem.email)&&axios.post("/api/admin/email/verify",{email:this.editedItem.email}).then((function(t){e.success=t.data.data.message,e.error=""})).catch((function(t){e.success="",e.error="Email Already Exists"}))},selectAll:function(e){this.selected=[],e.length>0&&(this.selected=e.map((function(e){return e.id}))),console.dir(this.selected)},deleteAll:function(){var e=this;confirm("Are you sure you want to delete these items?")&&axios.post("/api/admin/products/delete",{products:this.selected}).then((function(t){e.text="Rcords Deleted Successfully!",e.selected.map((function(t){var a=e.products.data.indexOf(t);e.products.data.splice(a,1)})),e.snackbar=!0})).catch((function(t){console.log(t.response),e.text="Error Deleting Record",e.snackbar=!0}))},searchIt:function(e){var t=this;if(e.length>3&&axios.get("/api/admin/products/".concat(e)).then((function(e){return t.products=e.data.data.users})).catch((function(e){return console.dir(e.response)})),e.length<=0){var a=0==this.options.sortBy.length?"name":this.options.sortBy[0],i=this.options.sortDesc.length>0||this.options.sortDesc[0]?"asc":"desc";axios.get("/api/admin/products?page=".concat(e.page),{params:{per_page:e.itemsPerPage,sort_by:a,order_by:i}}).then((function(e){t.products=e.data.data.products})).catch((function(e){return console.dir(e.response)}))}},paginate:function(e){var t=this,a=0==this.options.sortBy.length?"name":this.options.sortBy[0],i=this.options.sortDesc.length>0||this.options.sortDesc[0]?"asc":"desc";axios.get("/api/admin/products?page=".concat(e.page),{params:{per_page:e.itemsPerPage,sort_by:a,order_by:i}}).then((function(e){t.products=e.data.products,console.log(e)})).catch((function(e){401==e.response.status&&console.log(e)}))},initialize:function(){var e=this;axios.interceptors.request.use((function(t){return e.loading=!0,t}),(function(t){return e.loading=!1,Promise.reject(t)})),axios.interceptors.response.use((function(t){return e.loading=!1,t}),(function(t){return e.loading=!1,Promise.reject(t)}))},editItem:function(e){this.editedIndex=this.products.data.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem:function(e){var t=this,a=this.products.data.indexOf(e);confirm("Are you sure you want to delete this item?")&&axios.delete("/api/admin/products/"+e.id).then((function(e){t.snackbar=!0,t.products.data.splice(a,1)})).catch((function(e){console.log(e.response),t.text="Error Deleting Record",t.snackbar=!0}))},close:function(){var e=this;this.dialog=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){var e=this;if(this.editedIndex>-1){var t=this.editedIndex;axios.put("/api/admin/products/"+this.editedItem.id,this.editedItem).then((function(a){e.text="Record Updated Successfully!",e.snackbar=!0,Object.assign(e.products.data[t],a.data.data.product)})).catch((function(t){console.log(t.response),e.text="Error Updating Record",e.snackbar=!0}))}else axios.post("/api/admin/products",this.editedItem).then((function(t){e.$router.replace("/api/admin/products/".concat(t.data.product.slug),{params:{slug:t.data.product.slug}})})).catch((function(t){console.dir(t),e.text="Error Inserting Record",e.snackbar=!0}));this.close()},deleteRow:function(e,t){var a=this.editedItem.size_attribs.indexOf(t);console.log(a,e),a>-1&&this.editedItem.size_attribs.splice(a,1)},addNewRow:function(){this.editedItem.size_attribs.push({attribute:"",xs:"",s:"",m:"",l:"",xl:""})},link:function(e){this.$router.replace("/admin/products/".concat(e.slug))}}},s=a(0),n=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.products.data,"items-per-page":5,"item-key":"id",loading:e.loading,options:e.options,"server-items-length":e.products.total,"loading-text":"Loading.. Please Wait!","footer-props":{itemsPerPageOptions:[5,10,15],"show-current-page":!0,"show-first-last-page":!0}},on:{pagination:e.paginate,"update:options":function(t){e.options=t},input:e.selectAll},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:""}},[a("v-toolbar-title",[e._v("Products")]),e._v(" "),a("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),e._v(" "),a("v-spacer"),e._v(" "),a("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"mb-2",attrs:{color:"primary",dark:""}},i),[e._v("New Product")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),a("v-form",{attrs:{method:"post"},on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.save(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-card-text",[a("v-container",[a("v-row",{staticClass:"d-flex justify-space-around",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"5",md:"5",lg:"5",xl:"5"}},[a("v-text-field",{attrs:{label:"Name"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}}),e._v(" "),a("v-select",{attrs:{items:e.categories,"item-text":"name","item-value":"id",label:"Category"},model:{value:e.editedItem.category_id,callback:function(t){e.$set(e.editedItem,"category_id",t)},expression:"editedItem.category_id"}}),e._v(" "),a("v-textarea",{attrs:{name:"input-7-1",label:"Short Description",hint:"Hint text"},model:{value:e.editedItem.shortDescription,callback:function(t){e.$set(e.editedItem,"shortDescription",t)},expression:"editedItem.shortDescription"}})],1),e._v(" "),a("v-divider",{staticClass:"mx-4 hidden-xs-only",attrs:{vertical:""}}),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"5",md:"5",lg:"5",xl:"5"}},[a("v-text-field",{attrs:{label:"Price PKR"},model:{value:e.editedItem.price_pkr,callback:function(t){e.$set(e.editedItem,"price_pkr",t)},expression:"editedItem.price_pkr"}}),e._v(" "),a("v-text-field",{attrs:{label:"Price USD"},model:{value:e.editedItem.price_usd,callback:function(t){e.$set(e.editedItem,"price_usd",t)},expression:"editedItem.price_usd"}}),e._v(" "),a("v-text-field",{attrs:{label:"Price AUD"},model:{value:e.editedItem.price_aud,callback:function(t){e.$set(e.editedItem,"price_aud",t)},expression:"editedItem.price_aud"}}),e._v(" "),a("v-text-field",{attrs:{label:"Price EUR"},model:{value:e.editedItem.price_eur,callback:function(t){e.$set(e.editedItem,"price_eur",t)},expression:"editedItem.price_eur"}}),e._v(" "),a("v-text-field",{attrs:{label:"Price GBP"},model:{value:e.editedItem.price_gbp,callback:function(t){e.$set(e.editedItem,"price_gbp",t)},expression:"editedItem.price_gbp"}})],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{color:"primary",type:"submit",disabled:!e.valid},on:{click:function(t){return t.preventDefault(),e.save(t)}}},[e._v("Save")])],1)],1)],1)],1)],1),e._v(" "),a("v-text-field",{staticClass:"mx-4",attrs:{"append-icon":"mdi-search",label:"Search","single-line":"","hide-details":""},on:{input:e.searchIt}})]},proxy:!0},{key:"item.action",fn:function(t){var i=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.link(i)}}},[e._v("mdi-pencil")]),e._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(i)}}},[e._v("mdi-delete")])]}},{key:"no-data",fn:function(){return[a("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v("Reset")])]},proxy:!0},{key:"item.photo",fn:function(e){var t=e.item;return[a("v-avatar",{attrs:{size:"36px"}},[a("img",{attrs:{src:t.photo,alt:"Avatar"}})])]}},{key:"item.role",fn:function(t){var i=t.item;return[a("v-edit-dialog",{attrs:{large:"",block:"",persistent:"","return-value":i.role},on:{"update:returnValue":function(t){return e.$set(i,"role",t)},"update:return-value":function(t){return e.$set(i,"role",t)},save:function(t){return e.updateRole(i)}},scopedSlots:e._u([{key:"input",fn:function(){return[a("v-select",{attrs:{items:e.roles,label:"Select Role",rules:[e.rules.required]},model:{value:i.role,callback:function(t){e.$set(i,"role",t)},expression:"item.role"}})]},proxy:!0}],null,!0)},[e._v("\n      "+e._s(i.role)+"\n      ")])]}},{key:"item.image1",fn:function(e){var t=e.item;return[a("v-avatar",{attrs:{horizontal:"",size:"36px"}},[a("img",{attrs:{src:t.image1,alt:"Avatar"}})])]}}])},[e._v(" "),e._v(" "),e._v(" "),e._v(" "),e._v(" "),e._v(" "),a("v-snackbar",{model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n    "+e._s(e.text)+"\n    "),a("v-btn",{attrs:{color:"white",text:""},on:{click:function(t){e.snackbar=!1}}},[e._v("Close")])],1)],1)}),[],!1,null,null,null);t.default=n.exports}}]);