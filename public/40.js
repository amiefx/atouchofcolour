(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{261:function(t,e,i){"use strict";i.r(e);var a={layout:"admin",middleware:["auth","admin"],metaInfo:{title:"Products",titleTemplate:"%s | Khodgi"},components:{},data:function(){return{date:null,menu_special_price_start:null,menu_special_price_end:null,menu_new_from:null,menu_new_to:null,trip:{name:"",location:null,start:null,end:null},locations:["Australia","Barbados","Chile","Denmark","Equador","France"],attrib:"",attribs:[],subattrib:"",subattribs:[],valid:!0,dialog:!1,loading:!1,snackbar:!1,text:"",roles:[],success:"",error:"",categories:[],options:{sortBy:["id"],sortDesc:[!0]},status:[{text:"Active",value:!0},{text:"InActive",value:!1}],status2:[{text:"InStock",value:!0},{text:"Sold Out",value:!1}],rules:{required:function(t){return!!t||"This Field is Required"},min:function(t){return t.length>=5||"Minimum 5 Chracters Required"},validEmail:function(t){return/.+@.+\..+/.test(t)||"Email must be valid"}},headers:[{text:"#",value:"id"},{text:"Thumbnail",value:"image1"},{text:"Name",value:"name"},{text:"Price",value:"price"},{text:"Status",value:"is_active"},{text:"InStock",value:"in_stock"},{text:"Created",value:"created_at"},{text:"Actions",value:"action",sortable:!1}],products:[],editedIndex:-1,editedItem:{id:"",name:"",category_id:"",description:"",isActive:"",in_stock:"",price_pkr:"",price_usd:"",price_aud:"",price_eur:"",price_gbp:"",special_price_percentage:"",special_price_start:"",special_price_end:"",manage_inventory:"",quantity:"",image1:null,image2:null,image3:null,image4:null,new_from:"",new_to:"",created_at:"",size_attribs:[{attribute_set:"",attribute:"",xs:"",s:"",m:"",l:"",xl:""}]},defaultItem:{id:"",name:"",category_id:"",description:"",isActive:"",in_stock:"",price_pkr:"",price_usd:"",price_aud:"",price_eur:"",price_gbp:"",special_price_percentage:"",special_price_start:"",special_price_end:"",manage_inventory:"",quantity:"",image1:"",image2:"",image3:"",image4:"",new_from:"",new_to:"",created_at:""}}},computed:{formTitle:function(){return-1===this.editedIndex?"New Product":"Edit Product"},passwordMatch:function(){return this.editedItem.password==this.editedItem.rpassword||"Password does Not Match"}},watch:{dialog:function(t){t||this.close()}},created:function(){var t=this;this.initialize(),axios.get("/api/admin/attributes").then((function(e){t.subattribs=e.data.attributes})),axios.get("/api/admin/categories").then((function(e){t.categories=e.data.data}))},methods:{updateActiveStatus:function(t){var e=this,i=this.categories.indexOf(t);axios.post("/api/admin/products/change-active",{is_active:t.is_active,product:t.id}).then((function(t){e.text="Products active status updated successfully.",e.snackbar=!0})).catch((function(t){e.categories[i].role=t.response,e.snackbar=!0,console.dir(t.response)}))},updateStockLevel:function(t){var e=this,i=this.categories.indexOf(t);axios.post("/api/admin/products/change-stock",{in_stock:t.in_stock,product:t.id}).then((function(t){e.text="Products stock level updated successfully.",e.snackbar=!0})).catch((function(t){e.categories[i].role=t.response,e.snackbar=!0,console.dir(t.response)}))},uploadImage1:function(t){var e=this,i=t.target.files[0],a=new FileReader;i.size<1e6?(a.onloadend=function(t){e.editedItem.image1=a.result},a.readAsDataURL(i)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage2:function(t){var e=this,i=t.target.files[0],a=new FileReader;i.size<1e6?(a.onloadend=function(t){e.editedItem.image2=a.result},a.readAsDataURL(i)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage3:function(t){var e=this,i=t.target.files[0],a=new FileReader;i.size<1e6?(a.onloadend=function(t){e.editedItem.image3=a.result},a.readAsDataURL(i)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadImage4:function(t){var e=this,i=t.target.files[0],a=new FileReader;i.size<1e6?(a.onloadend=function(t){e.editedItem.image4=a.result},a.readAsDataURL(i)):(this.text="Image size is greater than 1MB.",this.snackbar=!0)},uploadPhoto:function(t){var e=this;if(null!=this.editedItem.photo){var i=this.products.data.indexOf(t),a=new FormData;a.append("photo",this.editedItem.photo,this.editedItem.photo.name),a.append("user",t.id),axios.post("/api/admin/change-photo",a).then((function(t){e.products.data[i].photo=t.data.data.user.photo,e.editedItem.photo=null})).catch((function(t){return console.log(t.response)}))}},updateRole:function(t){var e=this,i=this.products.data.indexOf(t);axios.post("/api/admin/change-role",{role:t.role,user:t.id}).then((function(t){e.text=t.data.data.user.name+"'s Role Updated to "+t.data.data.user.role,e.snackbar=!0})).catch((function(t){e.text=t.response.data.user.name+"'s Role Cannot be Updated"+t.response.data.user.role,e.products.data[i].role=t.response.data.user.role,e.snackbar=!0,console.dir(t.response)}))},checkEmail:function(){var t=this;/.+@.+\..+/.test(this.editedItem.email)&&axios.post("/api/admin/email/verify",{email:this.editedItem.email}).then((function(e){t.success=e.data.data.message,t.error=""})).catch((function(e){t.success="",t.error="Email Already Exists"}))},selectAll:function(t){this.selected=[],t.length>0&&(this.selected=t.map((function(t){return t.id})))},deleteAll:function(){var t=this;confirm("Are you sure you want to delete these items?")&&axios.post("/api/admin/products/delete",{products:this.selected}).then((function(e){t.text="Rcords Deleted Successfully!",t.selected.map((function(e){var i=t.products.data.indexOf(e);t.products.data.splice(i,1)})),t.snackbar=!0})).catch((function(e){console.log(e.response),t.text="Error Deleting Record",t.snackbar=!0}))},searchIt:function(t){var e=this;t.length>3&&axios.get("/api/admin/product-search/".concat(t)).then((function(t){return e.products=t.data.products})).catch((function(t){return console.dir(t.response)})),t.length<=0&&this.paginate(t)},paginate:function(t){var e=this,i=0==this.options.sortBy.length?"id":this.options.sortBy[0],a=this.options.sortDesc.length>0||this.options.sortDesc[0]?"desc":"asc";axios.get("/api/admin/products?page=".concat(t.page),{params:{per_page:t.itemsPerPage,sort_by:i,order_by:a}}).then((function(t){e.products=t.data.products})).catch((function(t){401==t.response.status&&console.log(t)}))},initialize:function(){var t=this;axios.interceptors.request.use((function(e){return t.loading=!0,e}),(function(e){return t.loading=!1,Promise.reject(e)})),axios.interceptors.response.use((function(e){return t.loading=!1,e}),(function(e){return t.loading=!1,Promise.reject(e)}))},editItem:function(t){this.editedIndex=this.products.data.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem:function(t){var e=this,i=this.products.data.indexOf(t);confirm("Are you sure you want to delete this item?")&&axios.delete("/api/admin/products/"+t.id).then((function(t){e.snackbar=!0,e.products.data.splice(i,1)})).catch((function(t){console.log(t.response),e.text="Error Deleting Record",e.snackbar=!0}))},close:function(){var t=this;this.dialog=!1,setTimeout((function(){t.editedItem=Object.assign({},t.defaultItem),t.editedIndex=-1}),300)},save:function(){var t=this;if(this.editedIndex>-1){var e=this.editedIndex;axios.put("/api/admin/products/"+this.editedItem.id,this.editedItem).then((function(i){t.text="Record Updated Successfully!",t.snackbar=!0,Object.assign(t.products.data[e],i.data.data.product)})).catch((function(e){console.log(e.response),t.text="Error Updating Record",t.snackbar=!0}))}else axios.post("/api/admin/products",this.editedItem).then((function(e){t.$router.replace("/admin/products/".concat(e.data.product.slug),{params:{slug:e.data.product.slug}})})).catch((function(e){console.dir(e),t.text="Error Inserting Record",t.snackbar=!0}));this.close()},deleteRow:function(t,e){var i=this.editedItem.size_attribs.indexOf(e);i>-1&&this.editedItem.size_attribs.splice(i,1)},addNewRow:function(){this.editedItem.size_attribs.push({attribute:"",xs:"",s:"",m:"",l:"",xl:""})},link:function(t){this.$router.replace("/admin/products/".concat(t.slug))},getColor:function(t){return 0==t?"red":"green"}}},s=i(0),n=Object(s.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.products.data,"items-per-page":5,"item-key":"id",loading:t.loading,options:t.options,"server-items-length":t.products.total,"loading-text":"Loading.. Please Wait!","footer-props":{itemsPerPageOptions:[5,10,15],"show-current-page":!0,"show-first-last-page":!0}},on:{pagination:t.paginate,"update:options":function(e){t.options=e},input:t.selectAll},scopedSlots:t._u([{key:"top",fn:function(){return[i("v-toolbar",{attrs:{flat:"",color:""}},[i("v-toolbar-title",[t._v("Products")]),t._v(" "),i("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t._v(" "),i("v-spacer"),t._v(" "),i("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-btn",t._g({staticClass:"mb-2",attrs:{color:"primary",dark:""}},a),[t._v("New Product")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v(t._s(t.formTitle))])]),t._v(" "),i("v-form",{attrs:{method:"post"},on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.save(e)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[i("v-card-text",[i("v-container",[i("v-row",{staticClass:"d-flex justify-space-around",attrs:{"no-gutters":""}},[i("v-col",{attrs:{cols:"12",sm:"5",md:"5",lg:"5",xl:"5"}},[i("v-text-field",{attrs:{label:"Name"},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}}),t._v(" "),i("v-select",{attrs:{items:t.categories,"item-text":"name","item-value":"id",label:"Category"},model:{value:t.editedItem.category_id,callback:function(e){t.$set(t.editedItem,"category_id",e)},expression:"editedItem.category_id"}}),t._v(" "),i("v-textarea",{attrs:{name:"input-7-1",label:"Short Description",hint:"Hint text"},model:{value:t.editedItem.shortDescription,callback:function(e){t.$set(t.editedItem,"shortDescription",e)},expression:"editedItem.shortDescription"}})],1),t._v(" "),i("v-divider",{staticClass:"mx-4 hidden-xs-only",attrs:{vertical:""}}),t._v(" "),i("v-col",{attrs:{cols:"12",sm:"5",md:"5",lg:"5",xl:"5"}},[i("v-text-field",{attrs:{label:"Price PKR"},model:{value:t.editedItem.price_pkr,callback:function(e){t.$set(t.editedItem,"price_pkr",e)},expression:"editedItem.price_pkr"}}),t._v(" "),i("v-text-field",{attrs:{label:"Price USD"},model:{value:t.editedItem.price_usd,callback:function(e){t.$set(t.editedItem,"price_usd",e)},expression:"editedItem.price_usd"}}),t._v(" "),i("v-text-field",{attrs:{label:"Price AUD"},model:{value:t.editedItem.price_aud,callback:function(e){t.$set(t.editedItem,"price_aud",e)},expression:"editedItem.price_aud"}}),t._v(" "),i("v-text-field",{attrs:{label:"Price EUR"},model:{value:t.editedItem.price_eur,callback:function(e){t.$set(t.editedItem,"price_eur",e)},expression:"editedItem.price_eur"}}),t._v(" "),i("v-text-field",{attrs:{label:"Price GBP"},model:{value:t.editedItem.price_gbp,callback:function(e){t.$set(t.editedItem,"price_gbp",e)},expression:"editedItem.price_gbp"}})],1)],1)],1)],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{color:"primary",text:""},on:{click:t.close}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{color:"primary",type:"submit",disabled:!t.valid},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("Save")])],1)],1)],1)],1)],1),t._v(" "),i("v-text-field",{staticClass:"mx-4",attrs:{"append-icon":"mdi-search",label:"Search","single-line":"","hide-details":""},on:{input:t.searchIt}})]},proxy:!0},{key:"item.action",fn:function(e){var a=e.item;return[i("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.link(a)}}},[t._v("mdi-pencil")]),t._v(" "),i("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(a)}}},[t._v("mdi-delete")])]}},{key:"no-data",fn:function(){return[i("v-btn",{attrs:{color:"primary"},on:{click:t.initialize}},[t._v("Reset")])]},proxy:!0},{key:"item.photo",fn:function(t){var e=t.item;return[i("v-avatar",{attrs:{size:"36px"}},[i("img",{attrs:{src:e.photo,alt:"Avatar"}})])]}},{key:"item.is_active",fn:function(e){var a=e.item;return[i("v-edit-dialog",{attrs:{large:"",block:"",persistent:"","return-value":a.is_active},on:{"update:returnValue":function(e){return t.$set(a,"is_active",e)},"update:return-value":function(e){return t.$set(a,"is_active",e)},save:function(e){return t.updateActiveStatus(a)}},scopedSlots:t._u([{key:"input",fn:function(){return[i("v-select",{attrs:{items:t.status,"item-text":t.status.text,"item-value":t.status.value,label:"Select Status"},model:{value:a.is_active,callback:function(e){t.$set(a,"is_active",e)},expression:"item.is_active"}})]},proxy:!0}],null,!0)},[i("v-chip",{attrs:{color:t.getColor(a.is_active),dark:""}},[1==a.is_active?i("span",[t._v("Active")]):i("span",[t._v("InActive")])])],1)]}},{key:"item.in_stock",fn:function(e){var a=e.item;return[i("v-edit-dialog",{attrs:{large:"",block:"",persistent:"","return-value":a.in_stock},on:{"update:returnValue":function(e){return t.$set(a,"in_stock",e)},"update:return-value":function(e){return t.$set(a,"in_stock",e)},save:function(e){return t.updateStockLevel(a)}},scopedSlots:t._u([{key:"input",fn:function(){return[i("v-select",{attrs:{items:t.status2,"item-text":t.status2.text,"item-value":t.status2.value,label:"Select stock level"},model:{value:a.in_stock,callback:function(e){t.$set(a,"in_stock",e)},expression:"item.in_stock"}})]},proxy:!0}],null,!0)},[i("v-chip",{attrs:{color:t.getColor(a.in_stock),dark:""}},[1==a.in_stock?i("span",[t._v("InStock")]):i("span",[t._v("Sold out")])])],1)]}},{key:"item.image1",fn:function(t){var e=t.item;return[i("v-avatar",{attrs:{horizontal:"",size:"36px"}},[i("img",{attrs:{src:e.image1,alt:"Avatar"}})])]}}])},[t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),i("v-snackbar",{model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.text)+"\n    "),i("v-btn",{attrs:{color:"white",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v("Close")])],1)],1)}),[],!1,null,null,null);e.default=n.exports}}]);